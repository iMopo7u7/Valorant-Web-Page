<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Preparar Partida - Valorant</title>
<style>
  :root {
    --bg-color: #0f1923;
    --card-color: #1a1a1a;
    --text-color: #e0e0e0;
    --primary-color: #ff4655;
    --secondary-color: #0f1923;
    --accent-color: #7688a8;
    --border-color: #2e2e2e;
    --team-a-color: #ff4655;
    --team-b-color: #0f8cff;
    --team-c-color: #4caf50;
    --team-d-color: #ff9800;
    --team-e-color: #9c27b0;
    --highlight-color: #ffcc00;
    --success-color: #4caf50;
    --error-color: #f44336;
    --eliminated-color: #ff465566;
    --winner-color: #4caf50;
  }
  * {
    margin: 0; padding: 0; box-sizing: border-box;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  }
  body {
    background-color: var(--bg-color);
    color: var(--text-color);
    min-height: 100vh;
    display: flex; flex-direction: column; align-items: center;
    padding: 20px;
  }
  h1 {
    text-align: center;
    margin-bottom: 20px;
    font-size: 2.5rem;
    background: linear-gradient(90deg, var(--team-a-color), var(--team-b-color));
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
  }
  .container {
    max-width: 1200px;
    width: 100%;
  }
  nav {
    display: flex;
    justify-content: center;
    margin-bottom: 25px;
    gap: 20px;
  }
  nav button {
    background: var(--primary-color);
    border: none;
    padding: 10px 25px;
    font-weight: 600;
    font-size: 1rem;
    color: white;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.3s;
  }
  nav button[disabled] {
    background: var(--accent-color);
    cursor: default;
  }
  nav button.active {
    background: var(--highlight-color);
    color: #333;
  }
  section {
    display: none;
  }
  section.active {
    display: block;
  }
  /* --- EQUIPOS --- */
  .config-section {
    background-color: var(--card-color);
    padding: 20px;
    border-radius: 10px;
  }
  .config-row {
    display: flex;
    gap: 20px;
    margin-bottom: 20px;
    flex-wrap: wrap;
  }
  .config-group {
    flex: 1;
    min-width: 200px;
  }
  .config-group label {
    display: block;
    margin-bottom: 8px;
    font-weight: 600;
  }
  select, input[type=number], input[type=text] {
    width: 100%;
    padding: 10px 15px;
    background-color: var(--bg-color);
    border: 1px solid var(--border-color);
    border-radius: 5px;
    color: var(--text-color);
    font-size: 16px;
  }
  .players-input {
    display: grid;
    grid-template-columns: repeat(auto-fill,minmax(200px,1fr));
    gap: 15px;
    margin-bottom: 20px;
  }
  .input-group label {
    margin-bottom: 5px;
    display: block;
    font-weight: 600;
  }
  .input-group input {
    background-color: var(--bg-color);
  }
  .controls {
    display: flex;
    justify-content: center;
    gap: 15px;
  }
  button.action-btn {
    background-color: var(--primary-color);
    color: white;
    border: none;
    border-radius: 5px;
    padding: 12px 25px;
    font-size: 1.1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
    display: flex;
    align-items: center;
    gap: 10px;
  }
  button.action-btn:disabled {
    background-color: var(--accent-color);
    cursor: not-allowed;
  }
  button.action-btn:hover:not(:disabled) {
    background-color: #e03a48;
  }
  .teams-container {
    display: grid;
    grid-template-columns: repeat(auto-fit,minmax(280px,1fr));
    gap: 30px;
    margin-top: 20px;
  }
  .team {
    background-color: var(--card-color);
    border-radius: 10px;
    padding: 20px;
    min-height: 200px;
  }
  .team-header {
    text-align: center;
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 1px solid var(--border-color);
  }
  .team-a .team-header { color: var(--team-a-color); }
  .team-b .team-header { color: var(--team-b-color); }
  .team-c .team-header { color: var(--team-c-color); }
  .team-d .team-header { color: var(--team-d-color); }
  .team-e .team-header { color: var(--team-e-color); }
  .team-header h2 {
    font-size: 1.8rem;
    margin-bottom: 5px;
  }
  .players-list {
    display: flex;
    flex-direction: column;
    gap: 10px;
  }
  .player-card {
    background-color: var(--bg-color);
    padding: 12px 15px;
    border-radius: 5px;
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .team-a .player-card { border-left: 4px solid var(--team-a-color); }
  .team-b .player-card { border-left: 4px solid var(--team-b-color); }
  .team-c .player-card { border-left: 4px solid var(--team-c-color); }
  .team-d .player-card { border-left: 4px solid var(--team-d-color); }
  .team-e .player-card { border-left: 4px solid var(--team-e-color); }
  .player-avatar {
    width: 30px; height: 30px;
    border-radius: 50%;
    background-color: var(--secondary-color);
    display: flex; justify-content: center; align-items: center;
    font-weight: bold;
  }
  .player-name { flex-grow: 1; }
  .status {
    text-align: center;
    margin: 15px 0 30px;
    min-height: 24px;
    font-size: 1.1rem;
    color: var(--accent-color);
  }
  .summary {
    background-color: var(--card-color);
    padding: 15px 20px;
    border-radius: 10px;
    margin-top: 20px;
    white-space: pre-line;
    font-size: 1.2rem;
    text-align: center;
    color: var(--text-color);
  }
  .summary .team-label {
    font-weight: 700;
    font-size: 1.3rem;
    margin: 10px 0 5px;
  }
  /* --- MAPAS --- */
  .maps-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 15px;
    margin-top: 20px;
    justify-items: center; /* <-- centrado de las cards dentro de la grid */
  }
  .map-card {
    background-color: var(--card-color);
    border-radius: 8px;
    padding: 20px;
    text-align: center;
    transition: all 0.3s;
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    height: 100px;
    width: 100%;
    max-width: 220px;
  }
  .map-card.eliminated {
    transform: scale(0.9);
    opacity: 0.5;
    background-color: var(--eliminated-color);
  }
  .map-card.winner {
    background-color: var(--winner-color);
    transform: scale(1.05);
    box-shadow: 0 0 20px rgba(76,175,80,0.5);
    animation: pulse 1.5s infinite;
  }
  .map-card.highlight {
    background-color: var(--highlight-color);
    box-shadow: 0 0 20px rgba(255,70,85,0.5);
    transform: scale(1.05);
  }
  @keyframes pulse {
    0% { transform: scale(1); box-shadow: 0 0 20px rgba(76,175,80,0.5); }
    50% { transform: scale(1.05); box-shadow: 0 0 30px rgba(76,175,80,0.8); }
    100% { transform: scale(1); box-shadow: 0 0 20px rgba(76,175,80,0.5); }
  }
  @keyframes ruleta {
    0% { transform: scale(1); }
    50% { transform: scale(1.1); }
    100% { transform: scale(1); }
  }
  .ruleta-animation {
    animation: ruleta 0.3s ease-out;
  }
  /* Responsive */
  @media (max-width: 600px) {
    .players-input {
      grid-template-columns: 1fr !important;
    }
    .maps-container {
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    }
    h1 { font-size: 2rem; }
  }
</style>
</head>
<body>
<div class="container">
  <h1>Preparar Partida - Valorant</h1>
  <nav>
    <button id="tab-teams" class="active">Equipos</button>
    <button id="tab-map" disabled>Mapa</button>
  </nav>

  <!-- SECCION EQUIPOS -->
  <section id="section-teams" class="active">
    <div class="config-section">
      <div class="config-row">
        <div class="config-group">
          <label for="total-players">Total de Jugadores</label>
          <select id="total-players">
            <option value="10" selected>10 (2 equipos)</option>
            <option value="15">15 (3 equipos)</option>
            <option value="20">20 (4 equipos)</option>
            <option value="25">25 (5 equipos)</option>
          </select>
        </div>
        <div class="config-group">
          <label for="players-per-team">Jugadores por Equipo</label>
          <input type="number" id="players-per-team" value="5" min="1" readonly />
        </div>
      </div>
      <div class="players-input" id="players-input"></div>
      <div class="controls">
        <button id="randomize-teams-btn" class="action-btn">
          <i class="fas fa-random"></i> Sortear Equipos y Lados
        </button>
        <button id="reset-teams-btn" class="action-btn" style="background-color: var(--accent-color); color: #333;">
          <i class="fas fa-redo"></i> Reiniciar
        </button>
      </div>
      <div class="status" id="status-teams"></div>
      <div class="teams-container" id="teams-container"></div>
      <div class="summary" id="matchup-summary" style="display:none;"></div>
    </div>
  </section>

  <!-- SECCION MAPA -->
  <section id="section-map">
    <div class="config-section">
      <div class="controls" style="justify-content: center; margin-bottom: 20px;">
        <button id="randomize-map-btn" class="action-btn" disabled>
          <i class="fas fa-random"></i> Sortear Mapa
        </button>
      </div>
      <div class="status" id="status-map"></div>
      <div class="maps-container" id="maps-container"></div>
    </div>
  </section>
</div>

<script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    // Variables DOM
    const tabTeams = document.getElementById('tab-teams');
    const tabMap = document.getElementById('tab-map');
    const sectionTeams = document.getElementById('section-teams');
    const sectionMap = document.getElementById('section-map');

    // Equipos
    const totalPlayersSelect = document.getElementById('total-players');
    const playersPerTeamInput = document.getElementById('players-per-team');
    const playersInputContainer = document.getElementById('players-input');
    const teamsContainer = document.getElementById('teams-container');
    const randomizeTeamsBtn = document.getElementById('randomize-teams-btn');
    const resetTeamsBtn = document.getElementById('reset-teams-btn');
    const statusTeams = document.getElementById('status-teams');
    const matchupSummary = document.getElementById('matchup-summary');

    // Mapa
    const mapsContainer = document.getElementById('maps-container');
    const randomizeMapBtn = document.getElementById('randomize-map-btn');
    const statusMap = document.getElementById('status-map');

    // Datos
    const teamColors = ['A', 'B', 'C', 'D', 'E'];
    const teamColorValues = {
      'A': getComputedStyle(document.documentElement).getPropertyValue('--team-a-color').trim(),
      'B': getComputedStyle(document.documentElement).getPropertyValue('--team-b-color').trim(),
      'C': getComputedStyle(document.documentElement).getPropertyValue('--team-c-color').trim(),
      'D': getComputedStyle(document.documentElement).getPropertyValue('--team-d-color').trim(),
      'E': getComputedStyle(document.documentElement).getPropertyValue('--team-e-color').trim()
    };

    const valorantMaps = [
      { id: 'ascent', name: 'Ascent' },
      { id: 'bind', name: 'Bind' },
      { id: 'breeze', name: 'Breeze' },
      { id: 'fracture', name: 'Fracture' },
      { id: 'haven', name: 'Haven' },
      { id: 'icebox', name: 'Icebox' },
      { id: 'lotus', name: 'Lotus' },
      { id: 'pearl', name: 'Pearl' },
      { id: 'split', name: 'Split' },
      { id: 'sunset', name: 'Sunset' },
      { id: 'abyss', name: 'Abyss' },
      { id: 'corrode', name: 'Corrode' }
    ];

    // Estado
    let players = [];
    let activeMaps = [...valorantMaps];
    let winnerMap = null;
    let isRandomizingMaps = false;

    // Navegación tabs
    tabTeams.addEventListener('click', () => {
      tabTeams.classList.add('active');
      tabMap.classList.remove('active');
      sectionTeams.classList.add('active');
      sectionMap.classList.remove('active');
    });
    tabMap.addEventListener('click', () => {
      if(randomizeMapBtn.disabled) return; // no avanzar si no habilitado
      tabMap.classList.add('active');
      tabTeams.classList.remove('active');
      sectionMap.classList.add('active');
      sectionTeams.classList.remove('active');
    });

    // Inicializar inputs y equipos
    function generatePlayerInputs(count) {
      playersInputContainer.innerHTML = '';
      for(let i=1; i<=count; i++) {
        const div = document.createElement('div');
        div.className = 'input-group';
        div.innerHTML = `
          <label for="player${i}">Jugador ${i}</label>
          <input type="text" id="player${i}" placeholder="Nombre del jugador" autocomplete="off" />
        `;
        playersInputContainer.appendChild(div);
      }
    }
    function generateTeamsDisplay(teamCount) {
      teamsContainer.innerHTML = '';
      for(let i=0; i<teamCount; i++) {
        const t = teamColors[i];
        const div = document.createElement('div');
        div.className = `team team-${t.toLowerCase()}`;
        div.innerHTML = `
          <div class="team-header">
            <h2>TEAM ${t}</h2>
            <p>0 jugadores</p>
          </div>
          <div class="players-list" id="team-${t.toLowerCase()}"></div>
        `;
        teamsContainer.appendChild(div);
      }
    }
    function updateTeamCounters() {
      const headers = document.querySelectorAll('.team-header p');
      headers.forEach(header => {
        const match = header.closest('.team').className.match(/team-([a-e])/);
        if (!match) return;
        const teamId = match[1].toUpperCase();
        const count = document.getElementById(`team-${teamId.toLowerCase()}`)?.children.length || 0;
        header.textContent = `${count} jugadores`;
      });
    }
    function clearTeams() {
      const lists = document.querySelectorAll('.players-list');
      lists.forEach(l => (l.innerHTML = ''));
      updateTeamCounters();
    }
    function renderTeams() {
      clearTeams();
      players.forEach(p => {
        const list = document.getElementById(`team-${p.team.toLowerCase()}`);
        if(list) {
          const div = document.createElement('div');
          div.className = 'player-card';
          div.innerHTML = `
            <div class="player-avatar">${p.id}</div>
            <div class="player-name">${p.name}</div>
          `;
          list.appendChild(div);
        }
      });
      updateTeamCounters();
    }

    // Inicial
    totalPlayersSelect.addEventListener('change', () => {
      const total = parseInt(totalPlayersSelect.value);
      const perTeam = 5;
      playersPerTeamInput.value = perTeam;
      generatePlayerInputs(total);
      generateTeamsDisplay(total / perTeam);
      players = [];
      statusTeams.textContent = '';
      matchupSummary.style.display = 'none';
      randomizeMapBtn.disabled = true;
      resetButtons();
    });
    totalPlayersSelect.dispatchEvent(new Event('change'));

    // Shuffle Fisher-Yates
    function shuffleArray(arr) {
      for(let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
    }

    // Botón sortear equipos y lados
    randomizeTeamsBtn.addEventListener('click', () => {
      statusTeams.textContent = '';
      const totalPlayers = parseInt(totalPlayersSelect.value);
      const playersPerTeam = parseInt(playersPerTeamInput.value);
      const teamsCount = totalPlayers / playersPerTeam;
      const teamsList = teamColors.slice(0, teamsCount);

      // Validar nombres
      players = [];
      for(let i=1; i<=totalPlayers; i++) {
        const inp = document.getElementById(`player${i}`);
        const val = inp.value.trim();
        if(val === '') {
          inp.focus();
          statusTeams.textContent = `Por favor ingresa el nombre de todos los jugadores. Falta jugador #${i}`;
          return;
        }
        players.push({id: i, name: val, team: null});
      }

      if(teamsCount < 2) {
        statusTeams.textContent = 'Debe haber al menos 2 equipos.';
        randomizeMapBtn.disabled = true;
        matchupSummary.style.display = 'none';
        return;
      }

      shuffleArray(players);

      for(let i=0; i<players.length; i++) {
        const teamIndex = Math.floor(i / playersPerTeam);
        players[i].team = teamColors[teamIndex];
      }

      renderTeams();

      // Helper para etiqueta de equipo con color
      function teamLabel(t) {
        return `<span class="team-label" style="color:${teamColorValues[t]}">TEAM ${t}</span>`;
      }

      let summaryHTML = '';

      if(teamsCount === 2) {
        // Elegir atacantes y defensores
        const attackerIndex = Math.floor(Math.random()*2);
        const defenderIndex = 1 - attackerIndex;
        const tA = teamsList[0];
        const tB = teamsList[1];

        summaryHTML += `<div>${teamLabel(tA)} vs ${teamLabel(tB)}</div>`;
        summaryHTML += `<div style="margin-top:8px;"><strong style="color:${teamColorValues[teamsList[attackerIndex]]}">Atacante:</strong> ${teamLabel(teamsList[attackerIndex])}</div>`;
        summaryHTML += `<div><strong style="color:${teamColorValues[teamsList[defenderIndex]]}">Defensor:</strong> ${teamLabel(teamsList[defenderIndex])}</div>`;
      } else if (teamsCount === 3) {
        // Primer enfrentamiento entre 2 equipos, tercero espera y jugará contra el ganador
        const shuffledTeams = [...teamsList];
        shuffleArray(shuffledTeams);
        const t1 = shuffledTeams[0], t2 = shuffledTeams[1], waiting = shuffledTeams[2];

        const attackerIndex = Math.floor(Math.random()*2);
        const attacker = attackerIndex === 0 ? t1 : t2;
        const defender = attacker === t1 ? t2 : t1;

        summaryHTML += `<div><strong>Primer enfrentamiento:</strong></div>`;
        summaryHTML += `<div style="margin-top:6px;">${teamLabel(t1)} vs ${teamLabel(t2)}</div>`;
        summaryHTML += `<div style="margin-top:8px;"><strong style="color:${teamColorValues[attacker]}">Atacante:</strong> ${teamLabel(attacker)}</div>`;
        summaryHTML += `<div><strong style="color:${teamColorValues[defender]}">Defensor:</strong> ${teamLabel(defender)}</div>`;

        // Info del equipo sobrante
        const waitingIsAttacker = Math.random() < 0.5;
        summaryHTML += `<div style="margin-top:12px;"><strong>En espera:</strong> ${teamLabel(waiting)} jugará contra <span class="team-label" style="color:var(--winner-color)">GANADOR</span></div>`;
        summaryHTML += `<div style="margin-top:6px;"><strong style="color:${waitingIsAttacker ? teamColorValues[waiting] : 'var(--winner-color)'}">Atacante:</strong> ${waitingIsAttacker ? teamLabel(waiting) : '<span style="color:var(--winner-color)">GANADOR</span>'}</div>`;
        summaryHTML += `<div><strong style="color:${!waitingIsAttacker ? teamColorValues[waiting] : 'var(--winner-color)'}">Defensor:</strong> ${!waitingIsAttacker ? teamLabel(waiting) : '<span style="color:var(--winner-color)">GANADOR</span>'}</div>`;
      } else if (teamsCount === 4) {
        // 2 partidos simultáneos
        const shuffledTeams = [...teamsList];
        shuffleArray(shuffledTeams);
        const m1a = shuffledTeams[0], m1b = shuffledTeams[1];
        const m2a = shuffledTeams[2], m2b = shuffledTeams[3];

        const attacker1 = Math.random() < 0.5 ? m1a : m1b;
        const defender1 = attacker1 === m1a ? m1b : m1a;
        const attacker2 = Math.random() < 0.5 ? m2a : m2b;
        const defender2 = attacker2 === m2a ? m2b : m2a;

        summaryHTML += `<div><strong>Enfrentamientos simultáneos:</strong></div>`;

        summaryHTML += `<div style="margin-top:8px;">${teamLabel(m1a)} vs ${teamLabel(m1b)}</div>`;
        summaryHTML += `<div style="margin-top:6px;"><strong style="color:${teamColorValues[attacker1]}">Atacante:</strong> ${teamLabel(attacker1)}</div>`;
        summaryHTML += `<div><strong style="color:${teamColorValues[defender1]}">Defensor:</strong> ${teamLabel(defender1)}</div>`;

        summaryHTML += `<div style="margin-top:12px;">${teamLabel(m2a)} vs ${teamLabel(m2b)}</div>`;
        summaryHTML += `<div style="margin-top:6px;"><strong style="color:${teamColorValues[attacker2]}">Atacante:</strong> ${teamLabel(attacker2)}</div>`;
        summaryHTML += `<div><strong style="color:${teamColorValues[defender2]}">Defensor:</strong> ${teamLabel(defender2)}</div>`;
      } else if (teamsCount === 5) {
        // 2 partidos y 1 equipo en espera para jugar contra el ganador
        const shuffledTeams = [...teamsList];
        shuffleArray(shuffledTeams);
        const m1a = shuffledTeams[0], m1b = shuffledTeams[1];
        const m2a = shuffledTeams[2], m2b = shuffledTeams[3];
        const waiting = shuffledTeams[4];

        const attacker1 = Math.random() < 0.5 ? m1a : m1b;
        const defender1 = attacker1 === m1a ? m1b : m1a;
        const attacker2 = Math.random() < 0.5 ? m2a : m2b;
        const defender2 = attacker2 === m2a ? m2b : m2a;

        summaryHTML += `<div><strong>Enfrentamientos:</strong></div>`;

        summaryHTML += `<div style="margin-top:8px;">${teamLabel(m1a)} vs ${teamLabel(m1b)}</div>`;
        summaryHTML += `<div style="margin-top:6px;"><strong style="color:${teamColorValues[attacker1]}">Atacante:</strong> ${teamLabel(attacker1)}</div>`;
        summaryHTML += `<div><strong style="color:${teamColorValues[defender1]}">Defensor:</strong> ${teamLabel(defender1)}</div>`;

        summaryHTML += `<div style="margin-top:12px;">${teamLabel(m2a)} vs ${teamLabel(m2b)}</div>`;
        summaryHTML += `<div style="margin-top:6px;"><strong style="color:${teamColorValues[attacker2]}">Atacante:</strong> ${teamLabel(attacker2)}</div>`;
        summaryHTML += `<div><strong style="color:${teamColorValues[defender2]}">Defensor:</strong> ${teamLabel(defender2)}</div>`;

        // Equipo en espera
        const waitingIsAttacker = Math.random() < 0.5;
        summaryHTML += `<div style="margin-top:12px; color: var(--accent-color);"><strong>Equipo en espera:</strong> ${teamLabel(waiting)} jugará contra <span class="team-label" style="color:var(--winner-color)">GANADOR</span></div>`;
        summaryHTML += `<div style="margin-top:6px;"><strong style="color:${waitingIsAttacker ? teamColorValues[waiting] : 'var(--winner-color)'}">Atacante:</strong> ${waitingIsAttacker ? teamLabel(waiting) : '<span style="color:var(--winner-color)">GANADOR</span>'}</div>`;
        summaryHTML += `<div><strong style="color:${!waitingIsAttacker ? teamColorValues[waiting] : 'var(--winner-color)'}">Defensor:</strong> ${!waitingIsAttacker ? teamLabel(waiting) : '<span style="color:var(--winner-color)">GANADOR</span>'}</div>`;
      } else {
        // fallback (no debería ocurrir con los select actuales)
        summaryHTML = 'No se pudo generar el resumen de enfrentamientos.';
      }

      matchupSummary.innerHTML = summaryHTML;
      matchupSummary.style.display = 'block';

      statusTeams.textContent = 'Equipos y lados sorteados correctamente.';

      // Bloquear botón de sorteo equipos y habilitar botón de mapa
      randomizeTeamsBtn.disabled = true;
      randomizeMapBtn.disabled = false;
      tabMap.disabled = false;
    });

    // Resetear equipos
    resetTeamsBtn.addEventListener('click', () => {
      totalPlayersSelect.dispatchEvent(new Event('change'));
      statusTeams.textContent = '';
      matchupSummary.style.display = 'none';
      randomizeTeamsBtn.disabled = false;
      randomizeMapBtn.disabled = true;
      tabMap.disabled = true;
    });

    // Renderizar mapas
    function renderMaps() {
      mapsContainer.innerHTML = '';
      activeMaps.forEach(map => {
        const div = document.createElement('div');
        div.className = 'map-card';
        if(winnerMap && winnerMap.id === map.id) div.classList.add('winner');
        div.id = `map-${map.id}`;
        div.dataset.id = map.id;
        div.innerHTML = `<h3>${map.name}</h3>`;
        mapsContainer.appendChild(div);
      });
    }
    renderMaps();

    // Animación y sorteo mapa
    let eliminationInterval = null;
    const fixedDelay = 800;

    randomizeMapBtn.addEventListener('click', () => {
      if(isRandomizingMaps) {
        resetMapRandomization();
        return;
      }
      if(activeMaps.length <= 1) {
        resetMapRandomization();
        return;
      }

      isRandomizingMaps = true;
      randomizeMapBtn.innerHTML = '<i class="fas fa-stop"></i> Detener';
      statusMap.textContent = 'Sorteando mapa...';

      eliminationInterval = setInterval(() => {
        if(activeMaps.length === 1) {
          finishMapRandomization();
          return;
        }
        const randomIndex = Math.floor(Math.random() * activeMaps.length);
        const mapToEliminate = activeMaps[randomIndex];
        highlightMap(mapToEliminate.id, () => {
          if(activeMaps.length > 1) {
            eliminateMap(mapToEliminate.id);
            if(activeMaps.length === 1) finishMapRandomization();
          }
        });
      }, fixedDelay);
    });

    function highlightMap(mapId, callback) {
      const mapEl = document.getElementById(`map-${mapId}`);
      if(!mapEl) return;
      mapEl.classList.add('highlight');
      mapEl.classList.add('ruleta-animation');
      setTimeout(() => {
        mapEl.classList.remove('highlight');
        mapEl.classList.remove('ruleta-animation');
        if(callback) callback();
      }, 500);
    }
    function eliminateMap(mapId) {
      if(activeMaps.length <= 1) return;
      const idx = activeMaps.findIndex(m => m.id === mapId);
      if(idx === -1) return;
      const el = document.getElementById(`map-${mapId}`);
      if(el) el.classList.add('eliminated');
      activeMaps.splice(idx, 1);
      statusMap.textContent = `Quedan ${activeMaps.length} mapas...`;
    }
    function finishMapRandomization() {
      clearInterval(eliminationInterval);
      if(activeMaps.length === 1) {
        winnerMap = activeMaps[0];
        const winnerEl = document.getElementById(`map-${winnerMap.id}`);
        if(winnerEl) winnerEl.classList.add('winner');
        statusMap.textContent = `¡Mapa seleccionado: ${winnerMap.name}!`;
      }
      randomizeMapBtn.innerHTML = '<i class="fas fa-redo"></i> Reiniciar';
      isRandomizingMaps = false;
    }
    function resetMapRandomization() {
      clearInterval(eliminationInterval);
      activeMaps = [...valorantMaps];
      winnerMap = null;
      renderMaps();
      statusMap.textContent = '';
      randomizeMapBtn.innerHTML = '<i class="fas fa-random"></i> Sortear Mapa';
      isRandomizingMaps = false;
    }

    // Resetea ambos botones a estados iniciales
    function resetButtons() {
      randomizeTeamsBtn.disabled = false;
      randomizeMapBtn.disabled = true;
      tabMap.disabled = true;
    }
  });
</script>
</body>
</html>
